<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />

<script src="http://cdn.robotwebtools.org/threejs/current/three.min.js"></script>
<script src="http://cdn.robotwebtools.org/threejs/current/ColladaLoader.min.js"></script>
<script src="http://cdn.robotwebtools.org/ColladaAnimationCompress/current/ColladaLoader2.min.js"></script>
<script src="http://cdn.robotwebtools.org/threejs/current/STLLoader.min.js"></script>
<script src="http://cdn.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
<script src="http://cdn.robotwebtools.org/roslibjs/current/roslib.min.js"></script>
<script src="http://cdn.robotwebtools.org/ros3djs/current/ros3d.min.js"></script>
<script type="text/javascript" src="dat.gui.js"></script>
<div class="progress" id="battery">
  <!-- initial battery life -->
  <div class="bar" style="width: 60%;"></div>
</div>
  <script type="text/javascript">
    var obj = { x: 5 };
    var gui = new dat.GUI();
	gui.add(obj, 'x');
		
  </script>
 

<script>
  /**
   * Setup all visualization elements when the page is loaded.
   */
  function init() {
    // Connect to ROS.
    var ros = new ROSLIB.Ros({
      url : 'ws://192.168.1.1:9090'
    });

    // Create the main viewer.
    var viewer = new ROS3D.Viewer({
		divID : 'urdf',
		width : 800,
		height : 600,
		background: "#AAAAAA",
		antialias : true,

	    });
	    // Add a grid.
	    viewer.addObject(new ROS3D.Grid());
	    viewer.addObject(createUrdfClient(this.scene, this.fixedFrame));

	    function updateViewer() {
		// only resize if the viewer is actually visible
		viewer.camera.updateProjectionMatrix();
		    }
		function createTfClient(fixedFrame) {
		    return new ROSLIB.TFClient({
			ros : ros,
			angularThres : 0.01,
			transThres : 0.01,
			rate : 10.0,
			fixedFrame: fixedFrame
		    });
		}
	    function createUrdfClient(scene, fixedFrame) {
		    return new ROS3D.UrdfClient({
			ros : ros,
			tfClient : createTfClient(fixedFrame),
			path : 'http://resources.robotwebtools.org/',
			rootObject : scene,
			loader : ROS3D.COLLADA_LOADER_2
		    });
		}
	
    var battery =  "/Power/Battery "
      battery.on("update", function() {
      $("#battery .bar").css("width", battery.life + "%");
});

  }
</script>
</head>

<body onload="init()">
  <h1>This is a test</h1>
  <div id="urdf"></div>
</body>
</html>
